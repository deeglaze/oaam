(define narf #f)
(define (insert cmp)
  (位 (a lst)
     (set! narf cmp)
   (cond [(null? lst) (list a)]
         [else
          (define l0 (car lst))
          (if (cmp a l0)
              (cons a lst)
              (cons l0 ((insert cmp) a (cdr lst))))])))
(define (foldl f b lst)
  (if (null? lst)
      b
      (foldl f (f (car lst) b) (cdr lst))))
(define (sort cmp lst)
  (foldl (insert cmp) '() lst))
(define (listof f)
  (位 (lst)
   (or (null? lst)
       (and (f (car lst)) ((listof f) (cdr lst))))))
(define csort 
  (tmon 'user 'context 'contract
        ('sort : ('cmp : number? number? -> boolean?)
               (listof number?)
               ->
                                       (listof number?)
               )
        (and (not (seq ... (call (label sort) _ _) (star (!ret (label sort) _)) (call (label sort) _ _)))
           
         (not (seq ... (bind (call (label sort) (? cmp) _)
                             (seq ... (ret (label sort) _)
                                  ... (call ($ cmp) _ _))))))
        sort))
(define lst (list 1 2 3 4))
(define cmp (位 (x y) (<= x y)))
(define (map f lst) (if (null? lst) '() (cons (f (car lst)) (map f (cdr lst)))))
(define (csortcmp lst) (csort cmp lst))
(map csortcmp (list (list 0 1 2 4 5)
                    (list 4 5 6 7)
                    (list 0 8 9)
                    (map (位 (x) x) (list 5 9 10 22 -1))))
